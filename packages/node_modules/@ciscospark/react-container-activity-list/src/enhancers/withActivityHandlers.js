import {withHandlers, compose} from 'recompose';
import {connect} from 'react-redux';
import {bindActionCreators} from 'redux';

import {retryFailedMessage} from '@ciscospark/redux-module-messaging';

function handleActivityRetry(props) {
  return (activityId) => {
    const {
      activity,
      sparkInstance
    } = props;
    const failedActivity = activity.getIn(['activityFailures', activityId]);
    return props.retryFailedMessage(sparkInstance, failedActivity);
  };
}

export default compose(
  connect(
    null,
    (dispatch) => bindActionCreators({
      retryFailedMessage
    }, dispatch)
  ),
  withHandlers({
    onActivityRetry: handleActivityRetry
  })
);
