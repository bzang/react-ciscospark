import {compose, lifecycle} from 'recompose';
import {connect} from 'react-redux';
import {bindActionCreators} from 'redux';

import {
  getFeature,
  FEATURE_MENTIONS
} from '@ciscospark/redux-module-features';


export default compose(
  connect(
    null,
    (dispatch) => bindActionCreators({
      getFeature
    }, dispatch)
  ),
  lifecycle({
    componentWillUpdate(nextProps) {
      const {props} = this;

      if (!nextProps.features.hasIn(['items', FEATURE_MENTIONS])) {
        props.getFeature('developer', FEATURE_MENTIONS, nextProps.sparkInstance);
      }
    }
  })
);
