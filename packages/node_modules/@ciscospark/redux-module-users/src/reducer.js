import {fromJS} from 'immutable';

import {
  REQUEST_CURRENT_USER,
  STORE_CURRENT_USER,
  STORE_USER
} from './actions';

export const initialState = fromJS({
  currentUserId: null,
  items: {}
});

export default function reducer(state = initialState, action) {
  switch (action.type) {

    case REQUEST_CURRENT_USER:
    return state.set(`currentUserId`, `pending`);

  case STORE_CURRENT_USER: {
    const user = action.payload.user;
    return state.setIn([`items`, user.id], user)
      .set(`currentUserId`, user.id);
  }

  case STORE_USER: {
    const user = action.payload.user;
    return state.setIn([`items`, user.id], user);
  }

  default:
    return state;
  }
}
